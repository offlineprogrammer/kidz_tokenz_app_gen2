import _fsp from 'fs/promises';
import path from 'path';
import { ClientConfigFormat, } from '../client-config-types/client_config.js';
/**
 * A class that persists client config to disk.
 */
export class ClientConfigWriter {
    pathResolver;
    formatter;
    fsp;
    /**
     * Creates client config writer
     */
    constructor(pathResolver, formatter, fsp = _fsp) {
        this.pathResolver = pathResolver;
        this.formatter = formatter;
        this.fsp = fsp;
    }
    /**
     * Persists provided client config as json file to target path.
     */
    writeClientConfig = async (clientConfig, outDir, format = ClientConfigFormat.JSON, 
    // TODO: update this type when Printer interface gets defined in platform-core.
    log) => {
        const targetPath = await this.pathResolver(outDir, format);
        const fileContent = this.formatter.format(clientConfig, format);
        await this.fsp.writeFile(targetPath, fileContent);
        log?.(`File written: ${path.relative(process.cwd(), targetPath)}`);
    };
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2xpZW50X2NvbmZpZ193cml0ZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvY2xpZW50LWNvbmZpZy13cml0ZXIvY2xpZW50X2NvbmZpZ193cml0ZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxJQUFJLE1BQU0sYUFBYSxDQUFDO0FBQy9CLE9BQU8sSUFBSSxNQUFNLE1BQU0sQ0FBQztBQUN4QixPQUFPLEVBRUwsa0JBQWtCLEdBQ25CLE1BQU0seUNBQXlDLENBQUM7QUFRakQ7O0dBRUc7QUFDSCxNQUFNLE9BQU8sa0JBQWtCO0lBS1Y7SUFDQTtJQUNBO0lBTm5COztPQUVHO0lBQ0gsWUFDbUIsWUFBc0MsRUFDdEMsU0FBZ0MsRUFDaEMsTUFBTSxJQUFJO1FBRlYsaUJBQVksR0FBWixZQUFZLENBQTBCO1FBQ3RDLGNBQVMsR0FBVCxTQUFTLENBQXVCO1FBQ2hDLFFBQUcsR0FBSCxHQUFHLENBQU87SUFDMUIsQ0FBQztJQUNKOztPQUVHO0lBQ0gsaUJBQWlCLEdBQUcsS0FBSyxFQUN2QixZQUEwQixFQUMxQixNQUFlLEVBQ2YsU0FBNkIsa0JBQWtCLENBQUMsSUFBSTtJQUNwRCwrRUFBK0U7SUFDL0UsR0FBK0IsRUFDaEIsRUFBRTtRQUNqQixNQUFNLFVBQVUsR0FBRyxNQUFNLElBQUksQ0FBQyxZQUFZLENBQUMsTUFBTSxFQUFFLE1BQU0sQ0FBQyxDQUFDO1FBQzNELE1BQU0sV0FBVyxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLFlBQVksRUFBRSxNQUFNLENBQUMsQ0FBQztRQUNoRSxNQUFNLElBQUksQ0FBQyxHQUFHLENBQUMsU0FBUyxDQUFDLFVBQVUsRUFBRSxXQUFXLENBQUMsQ0FBQztRQUNsRCxHQUFHLEVBQUUsQ0FBQyxpQkFBaUIsSUFBSSxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsR0FBRyxFQUFFLEVBQUUsVUFBVSxDQUFDLEVBQUUsQ0FBQyxDQUFDO0lBQ3JFLENBQUMsQ0FBQztDQUNIIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IF9mc3AgZnJvbSAnZnMvcHJvbWlzZXMnO1xuaW1wb3J0IHBhdGggZnJvbSAncGF0aCc7XG5pbXBvcnQge1xuICBDbGllbnRDb25maWcsXG4gIENsaWVudENvbmZpZ0Zvcm1hdCxcbn0gZnJvbSAnLi4vY2xpZW50LWNvbmZpZy10eXBlcy9jbGllbnRfY29uZmlnLmpzJztcbmltcG9ydCB7IENsaWVudENvbmZpZ0Zvcm1hdHRlciB9IGZyb20gJy4vY2xpZW50X2NvbmZpZ19mb3JtYXR0ZXIuanMnO1xuXG5leHBvcnQgdHlwZSBDbGllbnRDb25maWdQYXRoUmVzb2x2ZXIgPSAoXG4gIG91dERpcj86IHN0cmluZyxcbiAgZm9ybWF0PzogQ2xpZW50Q29uZmlnRm9ybWF0XG4pID0+IFByb21pc2U8c3RyaW5nPjtcblxuLyoqXG4gKiBBIGNsYXNzIHRoYXQgcGVyc2lzdHMgY2xpZW50IGNvbmZpZyB0byBkaXNrLlxuICovXG5leHBvcnQgY2xhc3MgQ2xpZW50Q29uZmlnV3JpdGVyIHtcbiAgLyoqXG4gICAqIENyZWF0ZXMgY2xpZW50IGNvbmZpZyB3cml0ZXJcbiAgICovXG4gIGNvbnN0cnVjdG9yKFxuICAgIHByaXZhdGUgcmVhZG9ubHkgcGF0aFJlc29sdmVyOiBDbGllbnRDb25maWdQYXRoUmVzb2x2ZXIsXG4gICAgcHJpdmF0ZSByZWFkb25seSBmb3JtYXR0ZXI6IENsaWVudENvbmZpZ0Zvcm1hdHRlcixcbiAgICBwcml2YXRlIHJlYWRvbmx5IGZzcCA9IF9mc3BcbiAgKSB7fVxuICAvKipcbiAgICogUGVyc2lzdHMgcHJvdmlkZWQgY2xpZW50IGNvbmZpZyBhcyBqc29uIGZpbGUgdG8gdGFyZ2V0IHBhdGguXG4gICAqL1xuICB3cml0ZUNsaWVudENvbmZpZyA9IGFzeW5jIChcbiAgICBjbGllbnRDb25maWc6IENsaWVudENvbmZpZyxcbiAgICBvdXREaXI/OiBzdHJpbmcsXG4gICAgZm9ybWF0OiBDbGllbnRDb25maWdGb3JtYXQgPSBDbGllbnRDb25maWdGb3JtYXQuSlNPTixcbiAgICAvLyBUT0RPOiB1cGRhdGUgdGhpcyB0eXBlIHdoZW4gUHJpbnRlciBpbnRlcmZhY2UgZ2V0cyBkZWZpbmVkIGluIHBsYXRmb3JtLWNvcmUuXG4gICAgbG9nPzogKG1lc3NhZ2U6IHN0cmluZykgPT4gdm9pZFxuICApOiBQcm9taXNlPHZvaWQ+ID0+IHtcbiAgICBjb25zdCB0YXJnZXRQYXRoID0gYXdhaXQgdGhpcy5wYXRoUmVzb2x2ZXIob3V0RGlyLCBmb3JtYXQpO1xuICAgIGNvbnN0IGZpbGVDb250ZW50ID0gdGhpcy5mb3JtYXR0ZXIuZm9ybWF0KGNsaWVudENvbmZpZywgZm9ybWF0KTtcbiAgICBhd2FpdCB0aGlzLmZzcC53cml0ZUZpbGUodGFyZ2V0UGF0aCwgZmlsZUNvbnRlbnQpO1xuICAgIGxvZz8uKGBGaWxlIHdyaXR0ZW46ICR7cGF0aC5yZWxhdGl2ZShwcm9jZXNzLmN3ZCgpLCB0YXJnZXRQYXRoKX1gKTtcbiAgfTtcbn1cbiJdfQ==