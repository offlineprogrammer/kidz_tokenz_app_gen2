import { existsSync as _existsSync } from 'fs';
import _fsp from 'fs/promises';
import { execa as _execa } from 'execa';
import * as _path from 'path';
import { LogLevel } from '../printer/printer.js';
import { printer } from '../printer.js';
import { executeWithDebugLogger as _executeWithDebugLogger } from './execute_with_debugger_logger.js';
/**
 * PackageManagerController is an abstraction around package manager commands that are needed to initialize a project and install dependencies
 */
export class PackageManagerControllerBase {
    cwd;
    executable;
    binaryRunner;
    initDefault;
    installCommand;
    fsp;
    path;
    execa;
    executeWithDebugLogger;
    existsSync;
    /**
     * constructor - sets the project root
     */
    constructor(cwd, executable, binaryRunner, initDefault, installCommand, fsp = _fsp, path = _path, execa = _execa, executeWithDebugLogger = _executeWithDebugLogger, existsSync = _existsSync) {
        this.cwd = cwd;
        this.executable = executable;
        this.binaryRunner = binaryRunner;
        this.initDefault = initDefault;
        this.installCommand = installCommand;
        this.fsp = fsp;
        this.path = path;
        this.execa = execa;
        this.executeWithDebugLogger = executeWithDebugLogger;
        this.existsSync = existsSync;
    }
    /**
     * installDependencies - installs dependencies in the project root
     */
    async installDependencies(packageNames, type) {
        const args = [`${this.installCommand}`].concat(...packageNames);
        if (type === 'dev') {
            args.push('-D');
        }
        await this.executeWithDebugLogger(this.cwd, this.executable, args, this.execa);
    }
    /**
     * getWelcomeMessage - returns a welcome message for the customer
     */
    getWelcomeMessage = () => `Run \`${this.binaryRunner} amplify help\` for a list of available commands. 
Get started by running \`${this.binaryRunner} amplify sandbox\`.`;
    /**
     * initializeProject - initializes a project in the project root by checking the package.json file
     */
    initializeProject = async () => {
        if (this.packageJsonExists(this.cwd)) {
            // if package.json already exists, no need to do anything
            return;
        }
        printer.log(`No package.json file found in the current directory. Running \`${this.executable} init\`...`, LogLevel.DEBUG);
        try {
            await this.executeWithDebugLogger(this.cwd, this.executable, this.initDefault, this.execa);
        }
        catch {
            throw new Error(`\`${this.executable} init\` did not exit successfully. Initialize a valid JavaScript package before continuing.`);
        }
        if (!this.packageJsonExists(this.cwd)) {
            // this should only happen if the customer exits out of npm init before finishing
            throw new Error(`package.json does not exist after running \`${this.executable} init\`. Initialize a valid JavaScript package before continuing.'`);
        }
    };
    /**
     * initializeTsConfig - initializes a tsconfig.json file in the project root
     */
    async initializeTsConfig(targetDir) {
        const tscArgs = [
            'tsc',
            '--init',
            '--resolveJsonModule',
            'true',
            '--module',
            'es2022',
            '--moduleResolution',
            'bundler',
            '--target',
            'es2022',
        ];
        await this.executeWithDebugLogger(targetDir, this.binaryRunner, tscArgs, this.execa);
    }
    /**
     * runWithPackageManager - Factory function that runs a command with the specified package manager's binary runner
     */
    runWithPackageManager(args = [], dir, options) {
        return this.executeWithDebugLogger(dir, this.binaryRunner, args, this.execa, options);
    }
    getCommand = (args) => `'${this.binaryRunner} ${args.join(' ')}'`;
    /**
     * Check if a package.json file exists in projectRoot
     */
    packageJsonExists = (projectRoot) => {
        return this.existsSync(this.path.resolve(projectRoot, 'package.json'));
    };
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGFja2FnZV9tYW5hZ2VyX2NvbnRyb2xsZXJfYmFzZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9wYWNrYWdlLW1hbmFnZXItY29udHJvbGxlci9wYWNrYWdlX21hbmFnZXJfY29udHJvbGxlcl9iYXNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxVQUFVLElBQUksV0FBVyxFQUFFLE1BQU0sSUFBSSxDQUFDO0FBQy9DLE9BQU8sSUFBSSxNQUFNLGFBQWEsQ0FBQztBQUMvQixPQUFPLEVBQXdDLEtBQUssSUFBSSxNQUFNLEVBQUUsTUFBTSxPQUFPLENBQUM7QUFDOUUsT0FBTyxLQUFLLEtBQUssTUFBTSxNQUFNLENBQUM7QUFFOUIsT0FBTyxFQUFFLFFBQVEsRUFBRSxNQUFNLHVCQUF1QixDQUFDO0FBQ2pELE9BQU8sRUFBRSxPQUFPLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDeEMsT0FBTyxFQUFFLHNCQUFzQixJQUFJLHVCQUF1QixFQUFFLE1BQU0sbUNBQW1DLENBQUM7QUFFdEc7O0dBRUc7QUFDSCxNQUFNLE9BQWdCLDRCQUE0QjtJQU8zQjtJQUNBO0lBQ0E7SUFDQTtJQUNBO0lBQ0E7SUFDQTtJQUNBO0lBQ0E7SUFDQTtJQWJyQjs7T0FFRztJQUNILFlBQ3FCLEdBQVcsRUFDWCxVQUFrQixFQUNsQixZQUFvQixFQUNwQixXQUFxQixFQUNyQixjQUFzQixFQUN0QixNQUFNLElBQUksRUFDVixPQUFPLEtBQUssRUFDWixRQUFRLE1BQU0sRUFDZCx5QkFBeUIsdUJBQXVCLEVBQ2hELGFBQWEsV0FBVztRQVR4QixRQUFHLEdBQUgsR0FBRyxDQUFRO1FBQ1gsZUFBVSxHQUFWLFVBQVUsQ0FBUTtRQUNsQixpQkFBWSxHQUFaLFlBQVksQ0FBUTtRQUNwQixnQkFBVyxHQUFYLFdBQVcsQ0FBVTtRQUNyQixtQkFBYyxHQUFkLGNBQWMsQ0FBUTtRQUN0QixRQUFHLEdBQUgsR0FBRyxDQUFPO1FBQ1YsU0FB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LENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxXQUFXLEVBQUUsY0FBYyxDQUFDLENBQUMsQ0FBQztJQUN6RSxDQUFDLENBQUM7Q0FDSCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGV4aXN0c1N5bmMgYXMgX2V4aXN0c1N5bmMgfSBmcm9tICdmcyc7XG5pbXBvcnQgX2ZzcCBmcm9tICdmcy9wcm9taXNlcyc7XG5pbXBvcnQgeyB0eXBlIEV4ZWNhQ2hpbGRQcm9jZXNzLCB0eXBlIE9wdGlvbnMsIGV4ZWNhIGFzIF9leGVjYSB9IGZyb20gJ2V4ZWNhJztcbmltcG9ydCAqIGFzIF9wYXRoIGZyb20gJ3BhdGgnO1xuaW1wb3J0IHsgdHlwZSBQYWNrYWdlTWFuYWdlckNvbnRyb2xsZXIgfSBmcm9tICdAYXdzLWFtcGxpZnkvcGx1Z2luLXR5cGVzJztcbmltcG9ydCB7IExvZ0xldmVsIH0gZnJvbSAnLi4vcHJpbnRlci9wcmludGVyLmpzJztcbmltcG9ydCB7IHByaW50ZXIgfSBmcm9tICcuLi9wcmludGVyLmpzJztcbmltcG9ydCB7IGV4ZWN1dGVXaXRoRGVidWdMb2dnZXIgYXMgX2V4ZWN1dGVXaXRoRGVidWdMb2dnZXIgfSBmcm9tICcuL2V4ZWN1dGVfd2l0aF9kZWJ1Z2dlcl9sb2dnZXIuanMnO1xuXG4vKipcbiAqIFBhY2thZ2VNYW5hZ2VyQ29udHJvbGxlciBpcyBhbiBhYnN0cmFjdGlvbiBhcm91bmQgcGFja2FnZSBtYW5hZ2VyIGNvbW1hbmRzIHRoYXQgYXJlIG5lZWRlZCB0byBpbml0aWFsaXplIGEgcHJvamVjdCBhbmQgaW5zdGFsbCBkZXBlbmRlbmNpZXNcbiAqL1xuZXhwb3J0IGFic3RyYWN0IGNsYXNzIFBhY2thZ2VNYW5hZ2VyQ29udHJvbGxlckJhc2VcbiAgaW1wbGVtZW50cyBQYWNrYWdlTWFuYWdlckNvbnRyb2xsZXJcbntcbiAgLyoqXG4gICAqIGNvbnN0cnVjdG9yIC0gc2V0cyB0aGUgcHJvamVjdCByb290XG4gICAqL1xuICBjb25zdHJ1Y3RvcihcbiAgICBwcm90ZWN0ZWQgcmVhZG9ubHkgY3dkOiBzdHJpbmcsXG4gICAgcHJvdGVjdGVkIHJlYWRvbmx5IGV4ZWN1dGFibGU6IHN0cmluZyxcbiAgICBwcm90ZWN0ZWQgcmVhZG9ubHkgYmluYXJ5UnVubmVyOiBzdHJpbmcsXG4gICAgcHJvdGVjdGVkIHJlYWRvbmx5IGluaXREZWZhdWx0OiBzdHJpbmdbXSxcbiAgICBwcm90ZWN0ZWQgcmVhZG9ubHkgaW5zdGFsbENvbW1hbmQ6IHN0cmluZyxcbiAgICBwcm90ZWN0ZWQgcmVhZG9ubHkgZnNwID0gX2ZzcCxcbiAgICBwcm90ZWN0ZWQgcmVhZG9ubHkgcGF0aCA9IF9wYXRoLFxuICAgIHByb3RlY3RlZCByZWFkb25seSBleGVjYSA9IF9leGVjYSxcbiAgICBwcm90ZWN0ZWQgcmVhZG9ubHkgZXhlY3V0ZVdpdGhEZWJ1Z0xvZ2dlciA9IF9leGVjdXRlV2l0aERlYnVnTG9nZ2VyLFxuICAgIHByb3RlY3RlZCByZWFkb25seSBleGlzdHNTeW5jID0gX2V4aXN0c1N5bmNcbiAgKSB7fVxuXG4gIC8qKlxuICAgKiBpbnN0YWxsRGVwZW5kZW5jaWVzIC0gaW5zdGFsbHMgZGVwZW5kZW5jaWVzIGluIHRoZSBwcm9qZWN0IHJvb3RcbiAgICovXG4gIGFzeW5jIGluc3RhbGxEZXBlbmRlbmNpZXMoXG4gICAgcGFja2FnZU5hbWVzOiBzdHJpbmdbXSxcbiAgICB0eXBlOiAnZGV2JyB8ICdwcm9kJ1xuICApOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBhcmdzID0gW2Ake3RoaXMuaW5zdGFsbENvbW1hbmR9YF0uY29uY2F0KC4uLnBhY2thZ2VOYW1lcyk7XG4gICAgaWYgKHR5cGUgPT09ICdkZXYnKSB7XG4gICAgICBhcmdzLnB1c2goJy1EJyk7XG4gICAgfVxuXG4gICAgYXdhaXQgdGhpcy5leGVjdXRlV2l0aERlYnVnTG9nZ2VyKFxuICAgICAgdGhpcy5jd2QsXG4gICAgICB0aGlzLmV4ZWN1dGFibGUsXG4gICAgICBhcmdzLFxuICAgICAgdGhpcy5leGVjYVxuICAgICk7XG4gIH1cblxuICAvKipcbiAgICogZ2V0V2VsY29tZU1lc3NhZ2UgLSByZXR1cm5zIGEgd2VsY29tZSBtZXNzYWdlIGZvciB0aGUgY3VzdG9tZXJcbiAgICovXG4gIGdldFdlbGNvbWVNZXNzYWdlID0gKCkgPT5cbiAgICBgUnVuIFxcYCR7dGhpcy5iaW5hcnlSdW5uZXJ9IGFtcGxpZnkgaGVscFxcYCBmb3IgYSBsaXN0IG9mIGF2YWlsYWJsZSBjb21tYW5kcy4gXG5HZXQgc3RhcnRlZCBieSBydW5uaW5nIFxcYCR7dGhpcy5iaW5hcnlSdW5uZXJ9IGFtcGxpZnkgc2FuZGJveFxcYC5gO1xuXG4gIC8qKlxuICAgKiBpbml0aWFsaXplUHJvamVjdCAtIGluaXRpYWxpemVzIGEgcHJvamVjdCBpbiB0aGUgcHJvamVjdCByb290IGJ5IGNoZWNraW5nIHRoZSBwYWNrYWdlLmpzb24gZmlsZVxuICAgKi9cbiAgaW5pdGlhbGl6ZVByb2plY3QgPSBhc3luYyAoKSA9PiB7XG4gICAgaWYgKHRoaXMucGFja2FnZUpzb25FeGlzdHModGhpcy5jd2QpKSB7XG4gICAgICAvLyBpZiBwYWNrYWdlLmpzb24gYWxyZWFkeSBleGlzdHMsIG5vIG5lZWQgdG8gZG8gYW55dGhpbmdcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBwcmludGVyLmxvZyhcbiAgICAgIGBObyBwYWNrYWdlLmpzb24gZmlsZSBmb3VuZCBpbiB0aGUgY3VycmVudCBkaXJlY3RvcnkuIFJ1bm5pbmcgXFxgJHt0aGlzLmV4ZWN1dGFibGV9IGluaXRcXGAuLi5gLFxuICAgICAgTG9nTGV2ZWwuREVCVUdcbiAgICApO1xuXG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IHRoaXMuZXhlY3V0ZVdpdGhEZWJ1Z0xvZ2dlcihcbiAgICAgICAgdGhpcy5jd2QsXG4gICAgICAgIHRoaXMuZXhlY3V0YWJsZSxcbiAgICAgICAgdGhpcy5pbml0RGVmYXVsdCxcbiAgICAgICAgdGhpcy5leGVjYVxuICAgICAgKTtcbiAgICB9IGNhdGNoIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgYFxcYCR7dGhpcy5leGVjdXRhYmxlfSBpbml0XFxgIGRpZCBub3QgZXhpdCBzdWNjZXNzZnVsbHkuIEluaXRpYWxpemUgYSB2YWxpZCBKYXZhU2NyaXB0IHBhY2thZ2UgYmVmb3JlIGNvbnRpbnVpbmcuYFxuICAgICAgKTtcbiAgICB9XG5cbiAgICBpZiAoIXRoaXMucGFja2FnZUpzb25FeGlzdHModGhpcy5jd2QpKSB7XG4gICAgICAvLyB0aGlzIHNob3VsZCBvbmx5IGhhcHBlbiBpZiB0aGUgY3VzdG9tZXIgZXhpdHMgb3V0IG9mIG5wbSBpbml0IGJlZm9yZSBmaW5pc2hpbmdcbiAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgYHBhY2thZ2UuanNvbiBkb2VzIG5vdCBleGlzdCBhZnRlciBydW5uaW5nIFxcYCR7dGhpcy5leGVjdXRhYmxlfSBpbml0XFxgLiBJbml0aWFsaXplIGEgdmFsaWQgSmF2YVNjcmlwdCBwYWNrYWdlIGJlZm9yZSBjb250aW51aW5nLidgXG4gICAgICApO1xuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogaW5pdGlhbGl6ZVRzQ29uZmlnIC0gaW5pdGlhbGl6ZXMgYSB0c2NvbmZpZy5qc29uIGZpbGUgaW4gdGhlIHByb2plY3Qgcm9vdFxuICAgKi9cbiAgYXN5bmMgaW5pdGlhbGl6ZVRzQ29uZmlnKHRhcmdldERpcjogc3RyaW5nKSB7XG4gICAgY29uc3QgdHNjQXJncyA9IFtcbiAgICAgICd0c2MnLFxuICAgICAgJy0taW5pdCcsXG4gICAgICAnLS1yZXNvbHZlSnNvbk1vZHVsZScsXG4gICAgICAndHJ1ZScsXG4gICAgICAnLS1tb2R1bGUnLFxuICAgICAgJ2VzMjAyMicsXG4gICAgICAnLS1tb2R1bGVSZXNvbHV0aW9uJyxcbiAgICAgICdidW5kbGVyJyxcbiAgICAgICctLXRhcmdldCcsXG4gICAgICAnZXMyMDIyJyxcbiAgICBdO1xuXG4gICAgYXdhaXQgdGhpcy5leGVjdXRlV2l0aERlYnVnTG9nZ2VyKFxuICAgICAgdGFyZ2V0RGlyLFxuICAgICAgdGhpcy5iaW5hcnlSdW5uZXIsXG4gICAgICB0c2NBcmdzLFxuICAgICAgdGhpcy5leGVjYVxuICAgICk7XG4gIH1cblxuICAvKipcbiAgICogcnVuV2l0aFBhY2thZ2VNYW5hZ2VyIC0gRmFjdG9yeSBmdW5jdGlvbiB0aGF0IHJ1bnMgYSBjb21tYW5kIHdpdGggdGhlIHNwZWNpZmllZCBwYWNrYWdlIG1hbmFnZXIncyBiaW5hcnkgcnVubmVyXG4gICAqL1xuICBydW5XaXRoUGFja2FnZU1hbmFnZXIoXG4gICAgYXJnczogc3RyaW5nW10gPSBbXSxcbiAgICBkaXI6IHN0cmluZyxcbiAgICBvcHRpb25zPzogT3B0aW9uczwndXRmOCc+XG4gICk6IEV4ZWNhQ2hpbGRQcm9jZXNzIHtcbiAgICByZXR1cm4gdGhpcy5leGVjdXRlV2l0aERlYnVnTG9nZ2VyKFxuICAgICAgZGlyLFxuICAgICAgdGhpcy5iaW5hcnlSdW5uZXIsXG4gICAgICBhcmdzLFxuICAgICAgdGhpcy5leGVjYSxcbiAgICAgIG9wdGlvbnNcbiAgICApO1xuICB9XG5cbiAgZ2V0Q29tbWFuZCA9IChhcmdzOiBzdHJpbmdbXSkgPT4gYCcke3RoaXMuYmluYXJ5UnVubmVyfSAke2FyZ3Muam9pbignICcpfSdgO1xuXG4gIC8qKlxuICAgKiBDaGVjayBpZiBhIHBhY2thZ2UuanNvbiBmaWxlIGV4aXN0cyBpbiBwcm9qZWN0Um9vdFxuICAgKi9cbiAgcHJpdmF0ZSBwYWNrYWdlSnNvbkV4aXN0cyA9IChwcm9qZWN0Um9vdDogc3RyaW5nKTogYm9vbGVhbiA9PiB7XG4gICAgcmV0dXJuIHRoaXMuZXhpc3RzU3luYyh0aGlzLnBhdGgucmVzb2x2ZShwcm9qZWN0Um9vdCwgJ3BhY2thZ2UuanNvbicpKTtcbiAgfTtcbn1cbiJdfQ==