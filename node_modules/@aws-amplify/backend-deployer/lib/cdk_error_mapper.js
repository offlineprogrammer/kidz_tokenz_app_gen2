import { AmplifyError, AmplifyFault, AmplifyUserError, } from '@aws-amplify/platform-core';
/**
 * Transforms CDK error messages to human readable ones
 */
export class CdkErrorMapper {
    knownErrors = [
        {
            errorRegex: /ExpiredToken/,
            humanReadableErrorMessage: 'The security token included in the request is invalid.',
            errorName: 'ExpiredTokenError',
            classification: 'ERROR',
        },
        {
            errorRegex: /Access Denied/,
            humanReadableErrorMessage: 'The deployment role does not have sufficient permissions to perform this deployment.',
            errorName: 'AccessDeniedError',
            classification: 'ERROR',
        },
        {
            errorRegex: /Has the environment been bootstrapped/,
            humanReadableErrorMessage: 'This AWS account and region has not been bootstrapped. Run `cdk bootstrap aws://{YOUR_ACCOUNT_ID}/{YOUR_REGION}` locally to resolve this.',
            errorName: 'BootstrapNotDetectedError',
            classification: 'ERROR',
        },
        {
            errorRegex: /(SyntaxError|ReferenceError):(.*)\n/,
            humanReadableErrorMessage: 'Unable to build Amplify backend. Check your backend definition in the `amplify` folder.',
            errorName: 'SyntaxError',
            classification: 'ERROR',
        },
        {
            errorRegex: /Amplify Backend not found in/,
            humanReadableErrorMessage: 'Backend definition could not be found in amplify directory',
            errorName: 'FileConventionError',
            classification: 'ERROR',
        },
        {
            errorRegex: /Amplify (.*) must be defined in (.*)/,
            humanReadableErrorMessage: 'File name or path for backend definition are incorrect',
            errorName: 'FileConventionError',
            classification: 'ERROR',
        },
        {
            // the backend entry point file is referenced in the stack indicating a problem in customer code
            errorRegex: /amplify\/backend/,
            humanReadableErrorMessage: 'Unable to build Amplify backend. Check your backend definition in the `amplify` folder.',
            errorName: 'BackendBuildError',
            classification: 'ERROR',
        },
        {
            errorRegex: /Updates are not allowed for property/,
            humanReadableErrorMessage: 'The changes that you are trying to apply are not supported.',
            errorName: 'CFNUpdateNotSupportedError',
            classification: 'ERROR',
        },
        {
            // This error originates from Cognito service when user tries to change UserPool attributes which is not allowed
            // https://docs.aws.amazon.com/cognito/latest/developerguide/user-pool-settings-attributes.html
            // Remapping to `UpdateNotSupported` will allow sandbox to prompt users for resetting their environment
            errorRegex: /Invalid AttributeDataType input, consider using the provided AttributeDataType enum/,
            humanReadableErrorMessage: 'User pool attributes cannot be changed after a user pool has been created.',
            errorName: 'CFNUpdateNotSupportedError',
            classification: 'ERROR',
        },
        {
            // Note that the order matters, this should be the last as it captures generic CFN error
            errorRegex: /âŒ Deployment failed: (.*)\n/,
            humanReadableErrorMessage: 'The CloudFormation deployment has failed. Find more information in the CloudFormation AWS Console for this stack.',
            errorName: 'CloudFormationDeploymentError',
            classification: 'ERROR',
        },
    ];
    getAmplifyError = (error) => {
        // Check if there was an Amplify error thrown during child process execution
        const amplifyError = AmplifyError.fromStderr(error.message);
        if (amplifyError) {
            return amplifyError;
        }
        const matchingError = this.knownErrors.find((knownError) => knownError.errorRegex.test(error.message));
        if (matchingError) {
            // Extract meaningful contextual information if available
            const underlyingMessage = error.message.match(matchingError.errorRegex);
            error.message =
                underlyingMessage && underlyingMessage.length > 1
                    ? underlyingMessage[0]
                    : error.message;
            return matchingError.classification === 'ERROR'
                ? new AmplifyUserError(matchingError.errorName, { message: matchingError.humanReadableErrorMessage }, error)
                : new AmplifyFault(matchingError.errorName, { message: matchingError.humanReadableErrorMessage }, error);
        }
        return AmplifyError.fromError(error);
    };
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2RrX2Vycm9yX21hcHBlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL3NyYy9jZGtfZXJyb3JfbWFwcGVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFDTCxZQUFZLEVBR1osWUFBWSxFQUVaLGdCQUFnQixHQUVqQixNQUFNLDRCQUE0QixDQUFDO0FBRXBDOztHQUVHO0FBQ0gsTUFBTSxPQUFPLGNBQWM7SUFDakIsV0FBVyxHQUtkO1FBQ0g7WUFDRSxVQUFVLEVBQUUsY0FBYztZQUMxQix5QkFBeUIsRUFDdkIsd0RBQXdEO1lBQzFELFNBQVMsRUFBRSxtQkFBbUI7WUFDOUIsY0FBYyxFQUFFLE9BQU87U0FDeEI7UUFDRDtZQUNFLFVBQVUsRUFBRSxlQUFlO1lBQzNCLHlCQUF5QixFQUN2QixzRkFBc0Y7WUFDeEYsU0FBUyxFQUFFLG1CQUFtQjtZQUM5QixjQUFjLEVBQUUsT0FBTztTQUN4QjtRQUNEO1lBQ0UsVUFBVSxFQUFFLHVDQUF1QztZQUNuRCx5QkFBeUIsRUFDdkIsMklBQTJJO1lBQzdJLFNBQVMsRUFBRSwyQkFBMkI7WUFDdEMsY0FBYyxFQUFFLE9BQU87U0FDeEI7UUFDRDtZQUNFLFVBQVUsRUFBRSxxQ0FBcUM7WUFDakQseUJBQXlCLEVBQ3ZCLHlGQUF5RjtZQUMzRixTQUFTLEVBQUUsYUFBYTtZQUN4QixjQUFjLEVBQUUsT0FBTztTQUN4QjtRQUNEO1lBQ0UsVUFBVSxFQUFFLDhCQUE4QjtZQUMxQyx5QkFBeUIsRUFDdkIsNERBQTREO1lBQzlELFNBQVMsRUFBRSxxQkFBcUI7WUFDaEMsY0FBYyxFQUFFLE9BQU87U0FDeEI7UUFDRDtZQUNFLFVBQVUsRUFBRSxzQ0FBc0M7WUFDbEQseUJBQXlCLEVBQ3ZCLHdEQUF3RDtZQUMxRCxTQUFTLEVBQUUscUJBQXFCO1lBQ2hDLGNBQWMsRUFBRSxPQUFPO1NBQ3hCO1FBQ0Q7WUFDRSxnR0FBZ0c7WUFDaEcsVUFBVSxFQUFFLGtCQUFrQjtZQUM5Qix5QkFBeUIsRUFDdkIseUZBQXlGO1lBQzNGLFNBQVMsRUFBRSxtQkFBbUI7WUFDOUIsY0FBYyxFQUFFLE9BQU87U0FDeEI7UUFDRDtZQUNFLFVBQVUsRUFBRSxzQ0FBc0M7WUFDbEQseUJBQXlCLEVBQ3ZCLDZEQUE2RDtZQUMvRCxTQUFTLEVBQUUsNEJBQTRCO1lBQ3ZDLGNBQWMsRUFBRSxPQUFPO1NBQ3hCO1FBQ0Q7WUFDRSxnSEFBZ0g7WUFDaEgsK0ZBQStGO1lBQy9GLHVHQUF1RztZQUN2RyxVQUFVLEVBQ1IscUZBQXFGO1lBQ3ZGLHlCQUF5QixFQUN2Qiw0RUFBNEU7WUFDOUUsU0FBUyxFQUFFLDRCQUE0QjtZQUN2QyxjQUFjLEVBQUUsT0FBTztTQUN4QjtRQUNEO1lBQ0Usd0ZBQXdGO1lBQ3hGLFVBQVUsRUFBRSw2QkFBNkI7WUFDekMseUJBQXlCLEVBQ3ZCLG1IQUFtSDtZQUNySCxTQUFTLEVBQUUsK0JBQStCO1lBQzFDLGNBQWMsRUFBRSxPQUFPO1NBQ3hCO0tBQ0YsQ0FBQztJQUVGLGVBQWUsR0FBRyxDQUFDLEtBQVksRUFBZ0IsRUFBRTtRQUMvQyw0RUFBNEU7UUFDNUUsTUFBTSxZQUFZLEdBQUcsWUFBWSxDQUFDLFVBQVUsQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDNUQsSUFBSSxZQUFZLEVBQUU7WUFDaEIsT0FBTyxZQUFZLENBQUM7U0FDckI7UUFFRCxNQUFNLGFBQWEsR0FBRyxJQUFJLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxDQUFDLFVBQVUsRUFBRSxFQUFFLENBQ3pELFVBQVUsQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FDMUMsQ0FBQztRQUVGLElBQUksYUFBYSxFQUFFO1lBQ2pCLHlEQUF5RDtZQUN6RCxNQUFNLGlCQUFpQixHQUFHLEtBQUssQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLGFBQWEsQ0FBQyxVQUFVLENBQUMsQ0FBQztZQUN4RSxLQUFLLENBQUMsT0FBTztnQkFDWCxpQkFBaUIsSUFBSSxpQkFBaUIsQ0FBQyxNQUFNLEdBQUcsQ0FBQztvQkFDL0MsQ0FBQyxDQUFDLGlCQUFpQixDQUFDLENBQUMsQ0FBQztvQkFDdEIsQ0FBQyxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUM7WUFFcEIsT0FBTyxhQUFhLENBQUMsY0FBYyxLQUFLLE9BQU87Z0JBQzdDLENBQUMsQ0FBQyxJQUFJLGdCQUFnQixDQUNsQixhQUFhLENBQUMsU0FBaUMsRUFDL0MsRUFBRSxPQUFPLEVBQUUsYUFBYSxDQUFDLHlCQUF5QixFQUFFLEVBQ3BELEtBQUssQ0FDTjtnQkFDSCxDQUFDLENBQUMsSUFBSSxZQUFZLENBQ2QsYUFBYSxDQUFDLFNBQW9DLEVBQ2xELEVBQUUsT0FBTyxFQUFFLGFBQWEsQ0FBQyx5QkFBeUIsRUFBRSxFQUNwRCxLQUFLLENBQ04sQ0FBQztTQUNQO1FBQ0QsT0FBTyxZQUFZLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ3ZDLENBQUMsQ0FBQztDQUNIIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgQW1wbGlmeUVycm9yLFxuICBBbXBsaWZ5RXJyb3JDbGFzc2lmaWNhdGlvbixcbiAgQW1wbGlmeUVycm9yVHlwZSxcbiAgQW1wbGlmeUZhdWx0LFxuICBBbXBsaWZ5TGlicmFyeUZhdWx0VHlwZSxcbiAgQW1wbGlmeVVzZXJFcnJvcixcbiAgQW1wbGlmeVVzZXJFcnJvclR5cGUsXG59IGZyb20gJ0Bhd3MtYW1wbGlmeS9wbGF0Zm9ybS1jb3JlJztcblxuLyoqXG4gKiBUcmFuc2Zvcm1zIENESyBlcnJvciBtZXNzYWdlcyB0byBodW1hbiByZWFkYWJsZSBvbmVzXG4gKi9cbmV4cG9ydCBjbGFzcyBDZGtFcnJvck1hcHBlciB7XG4gIHByaXZhdGUga25vd25FcnJvcnM6IEFycmF5PHtcbiAgICBlcnJvclJlZ2V4OiBSZWdFeHA7XG4gICAgaHVtYW5SZWFkYWJsZUVycm9yTWVzc2FnZTogc3RyaW5nO1xuICAgIGVycm9yTmFtZTogQW1wbGlmeUVycm9yVHlwZTtcbiAgICBjbGFzc2lmaWNhdGlvbjogQW1wbGlmeUVycm9yQ2xhc3NpZmljYXRpb247XG4gIH0+ID0gW1xuICAgIHtcbiAgICAgIGVycm9yUmVnZXg6IC9FeHBpcmVkVG9rZW4vLFxuICAgICAgaHVtYW5SZWFkYWJsZUVycm9yTWVzc2FnZTpcbiAgICAgICAgJ1RoZSBzZWN1cml0eSB0b2tlbiBpbmNsdWRlZCBpbiB0aGUgcmVxdWVzdCBpcyBpbnZhbGlkLicsXG4gICAgICBlcnJvck5hbWU6ICdFeHBpcmVkVG9rZW5FcnJvcicsXG4gICAgICBjbGFzc2lmaWNhdGlvbjogJ0VSUk9SJyxcbiAgICB9LFxuICAgIHtcbiAgICAgIGVycm9yUmVnZXg6IC9BY2Nlc3MgRGVuaWVkLyxcbiAgICAgIGh1bWFuUmVhZGFibGVFcnJvck1lc3NhZ2U6XG4gICAgICAgICdUaGUgZGVwbG95bWVudCByb2xlIGRvZXMgbm90IGhhdmUgc3VmZmljaWVudCBwZXJtaXNzaW9ucyB0byBwZXJmb3JtIHRoaXMgZGVwbG95bWVudC4nLFxuICAgICAgZXJyb3JOYW1lOiAnQWNjZXNzRGVuaWVkRXJyb3InLFxuICAgICAgY2xhc3NpZmljYXRpb246ICdFUlJPUicsXG4gICAgfSxcbiAgICB7XG4gICAgICBlcnJvclJlZ2V4OiAvSGFzIHRoZSBlbnZpcm9ubWVudCBiZWVuIGJvb3RzdHJhcHBlZC8sXG4gICAgICBodW1hblJlYWRhYmxlRXJyb3JNZXNzYWdlOlxuICAgICAgICAnVGhpcyBBV1MgYWNjb3VudCBhbmQgcmVnaW9uIGhhcyBub3QgYmVlbiBib290c3RyYXBwZWQuIFJ1biBgY2RrIGJvb3RzdHJhcCBhd3M6Ly97WU9VUl9BQ0NPVU5UX0lEfS97WU9VUl9SRUdJT059YCBsb2NhbGx5IHRvIHJlc29sdmUgdGhpcy4nLFxuICAgICAgZXJyb3JOYW1lOiAnQm9vdHN0cmFwTm90RGV0ZWN0ZWRFcnJvcicsXG4gICAgICBjbGFzc2lmaWNhdGlvbjogJ0VSUk9SJyxcbiAgICB9LFxuICAgIHtcbiAgICAgIGVycm9yUmVnZXg6IC8oU3ludGF4RXJyb3J8UmVmZXJlbmNlRXJyb3IpOiguKilcXG4vLFxuICAgICAgaHVtYW5SZWFkYWJsZUVycm9yTWVzc2FnZTpcbiAgICAgICAgJ1VuYWJsZSB0byBidWlsZCBBbXBsaWZ5IGJhY2tlbmQuIENoZWNrIHlvdXIgYmFja2VuZCBkZWZpbml0aW9uIGluIHRoZSBgYW1wbGlmeWAgZm9sZGVyLicsXG4gICAgICBlcnJvck5hbWU6ICdTeW50YXhFcnJvcicsXG4gICAgICBjbGFzc2lmaWNhdGlvbjogJ0VSUk9SJyxcbiAgICB9LFxuICAgIHtcbiAgICAgIGVycm9yUmVnZXg6IC9BbXBsaWZ5IEJhY2tlbmQgbm90IGZvdW5kIGluLyxcbiAgICAgIGh1bWFuUmVhZGFibGVFcnJvck1lc3NhZ2U6XG4gICAgICAgICdCYWNrZW5kIGRlZmluaXRpb24gY291bGQgbm90IGJlIGZvdW5kIGluIGFtcGxpZnkgZGlyZWN0b3J5JyxcbiAgICAgIGVycm9yTmFtZTogJ0ZpbGVDb252ZW50aW9uRXJyb3InLFxuICAgICAgY2xhc3NpZmljYXRpb246ICdFUlJPUicsXG4gICAgfSxcbiAgICB7XG4gICAgICBlcnJvclJlZ2V4OiAvQW1wbGlmeSAoLiopIG11c3QgYmUgZGVmaW5lZCBpbiAoLiopLyxcbiAgICAgIGh1bWFuUmVhZGFibGVFcnJvck1lc3NhZ2U6XG4gICAgICAgICdGaWxlIG5hbWUgb3IgcGF0aCBmb3IgYmFja2VuZCBkZWZpbml0aW9uIGFyZSBpbmNvcnJlY3QnLFxuICAgICAgZXJyb3JOYW1lOiAnRmlsZUNvbnZlbnRpb25FcnJvcicsXG4gICAgICBjbGFzc2lmaWNhdGlvbjogJ0VSUk9SJyxcbiAgICB9LFxuICAgIHtcbiAgICAgIC8vIHRoZSBiYWNrZW5kIGVudHJ5IHBvaW50IGZpbGUgaXMgcmVmZXJlbmNlZCBpbiB0aGUgc3RhY2sgaW5kaWNhdGluZyBhIHByb2JsZW0gaW4gY3VzdG9tZXIgY29kZVxuICAgICAgZXJyb3JSZWdleDogL2FtcGxpZnlcXC9iYWNrZW5kLyxcbiAgICAgIGh1bWFuUmVhZGFibGVFcnJvck1lc3NhZ2U6XG4gICAgICAgICdVbmFibGUgdG8gYnVpbGQgQW1wbGlmeSBiYWNrZW5kLiBDaGVjayB5b3VyIGJhY2tlbmQgZGVmaW5pdGlvbiBpbiB0aGUgYGFtcGxpZnlgIGZvbGRlci4nLFxuICAgICAgZXJyb3JOYW1lOiAnQmFja2VuZEJ1aWxkRXJyb3InLFxuICAgICAgY2xhc3NpZmljYXRpb246ICdFUlJPUicsXG4gICAgfSxcbiAgICB7XG4gICAgICBlcnJvclJlZ2V4OiAvVXBkYXRlcyBhcmUgbm90IGFsbG93ZWQgZm9yIHByb3BlcnR5LyxcbiAgICAgIGh1bWFuUmVhZGFibGVFcnJvck1lc3NhZ2U6XG4gICAgICAgICdUaGUgY2hhbmdlcyB0aGF0IHlvdSBhcmUgdHJ5aW5nIHRvIGFwcGx5IGFyZSBub3Qgc3VwcG9ydGVkLicsXG4gICAgICBlcnJvck5hbWU6ICdDRk5VcGRhdGVOb3RTdXBwb3J0ZWRFcnJvcicsXG4gICAgICBjbGFzc2lmaWNhdGlvbjogJ0VSUk9SJyxcbiAgICB9LFxuICAgIHtcbiAgICAgIC8vIFRoaXMgZXJyb3Igb3JpZ2luYXRlcyBmcm9tIENvZ25pdG8gc2VydmljZSB3aGVuIHVzZXIgdHJpZXMgdG8gY2hhbmdlIFVzZXJQb29sIGF0dHJpYnV0ZXMgd2hpY2ggaXMgbm90IGFsbG93ZWRcbiAgICAgIC8vIGh0dHBzOi8vZG9jcy5hd3MuYW1hem9uLmNvbS9jb2duaXRvL2xhdGVzdC9kZXZlbG9wZXJndWlkZS91c2VyLXBvb2wtc2V0dGluZ3MtYXR0cmlidXRlcy5odG1sXG4gICAgICAvLyBSZW1hcHBpbmcgdG8gYFVwZGF0ZU5vdFN1cHBvcnRlZGAgd2lsbCBhbGxvdyBzYW5kYm94IHRvIHByb21wdCB1c2VycyBmb3IgcmVzZXR0aW5nIHRoZWlyIGVudmlyb25tZW50XG4gICAgICBlcnJvclJlZ2V4OlxuICAgICAgICAvSW52YWxpZCBBdHRyaWJ1dGVEYXRhVHlwZSBpbnB1dCwgY29uc2lkZXIgdXNpbmcgdGhlIHByb3ZpZGVkIEF0dHJpYnV0ZURhdGFUeXBlIGVudW0vLFxuICAgICAgaHVtYW5SZWFkYWJsZUVycm9yTWVzc2FnZTpcbiAgICAgICAgJ1VzZXIgcG9vbCBhdHRyaWJ1dGVzIGNhbm5vdCBiZSBjaGFuZ2VkIGFmdGVyIGEgdXNlciBwb29sIGhhcyBiZWVuIGNyZWF0ZWQuJyxcbiAgICAgIGVycm9yTmFtZTogJ0NGTlVwZGF0ZU5vdFN1cHBvcnRlZEVycm9yJyxcbiAgICAgIGNsYXNzaWZpY2F0aW9uOiAnRVJST1InLFxuICAgIH0sXG4gICAge1xuICAgICAgLy8gTm90ZSB0aGF0IHRoZSBvcmRlciBtYXR0ZXJzLCB0aGlzIHNob3VsZCBiZSB0aGUgbGFzdCBhcyBpdCBjYXB0dXJlcyBnZW5lcmljIENGTiBlcnJvclxuICAgICAgZXJyb3JSZWdleDogL+KdjCBEZXBsb3ltZW50IGZhaWxlZDogKC4qKVxcbi8sXG4gICAgICBodW1hblJlYWRhYmxlRXJyb3JNZXNzYWdlOlxuICAgICAgICAnVGhlIENsb3VkRm9ybWF0aW9uIGRlcGxveW1lbnQgaGFzIGZhaWxlZC4gRmluZCBtb3JlIGluZm9ybWF0aW9uIGluIHRoZSBDbG91ZEZvcm1hdGlvbiBBV1MgQ29uc29sZSBmb3IgdGhpcyBzdGFjay4nLFxuICAgICAgZXJyb3JOYW1lOiAnQ2xvdWRGb3JtYXRpb25EZXBsb3ltZW50RXJyb3InLFxuICAgICAgY2xhc3NpZmljYXRpb246ICdFUlJPUicsXG4gICAgfSxcbiAgXTtcblxuICBnZXRBbXBsaWZ5RXJyb3IgPSAoZXJyb3I6IEVycm9yKTogQW1wbGlmeUVycm9yID0+IHtcbiAgICAvLyBDaGVjayBpZiB0aGVyZSB3YXMgYW4gQW1wbGlmeSBlcnJvciB0aHJvd24gZHVyaW5nIGNoaWxkIHByb2Nlc3MgZXhlY3V0aW9uXG4gICAgY29uc3QgYW1wbGlmeUVycm9yID0gQW1wbGlmeUVycm9yLmZyb21TdGRlcnIoZXJyb3IubWVzc2FnZSk7XG4gICAgaWYgKGFtcGxpZnlFcnJvcikge1xuICAgICAgcmV0dXJuIGFtcGxpZnlFcnJvcjtcbiAgICB9XG5cbiAgICBjb25zdCBtYXRjaGluZ0Vycm9yID0gdGhpcy5rbm93bkVycm9ycy5maW5kKChrbm93bkVycm9yKSA9PlxuICAgICAga25vd25FcnJvci5lcnJvclJlZ2V4LnRlc3QoZXJyb3IubWVzc2FnZSlcbiAgICApO1xuXG4gICAgaWYgKG1hdGNoaW5nRXJyb3IpIHtcbiAgICAgIC8vIEV4dHJhY3QgbWVhbmluZ2Z1bCBjb250ZXh0dWFsIGluZm9ybWF0aW9uIGlmIGF2YWlsYWJsZVxuICAgICAgY29uc3QgdW5kZXJseWluZ01lc3NhZ2UgPSBlcnJvci5tZXNzYWdlLm1hdGNoKG1hdGNoaW5nRXJyb3IuZXJyb3JSZWdleCk7XG4gICAgICBlcnJvci5tZXNzYWdlID1cbiAgICAgICAgdW5kZXJseWluZ01lc3NhZ2UgJiYgdW5kZXJseWluZ01lc3NhZ2UubGVuZ3RoID4gMVxuICAgICAgICAgID8gdW5kZXJseWluZ01lc3NhZ2VbMF1cbiAgICAgICAgICA6IGVycm9yLm1lc3NhZ2U7XG5cbiAgICAgIHJldHVybiBtYXRjaGluZ0Vycm9yLmNsYXNzaWZpY2F0aW9uID09PSAnRVJST1InXG4gICAgICAgID8gbmV3IEFtcGxpZnlVc2VyRXJyb3IoXG4gICAgICAgICAgICBtYXRjaGluZ0Vycm9yLmVycm9yTmFtZSBhcyBBbXBsaWZ5VXNlckVycm9yVHlwZSxcbiAgICAgICAgICAgIHsgbWVzc2FnZTogbWF0Y2hpbmdFcnJvci5odW1hblJlYWRhYmxlRXJyb3JNZXNzYWdlIH0sXG4gICAgICAgICAgICBlcnJvclxuICAgICAgICAgIClcbiAgICAgICAgOiBuZXcgQW1wbGlmeUZhdWx0KFxuICAgICAgICAgICAgbWF0Y2hpbmdFcnJvci5lcnJvck5hbWUgYXMgQW1wbGlmeUxpYnJhcnlGYXVsdFR5cGUsXG4gICAgICAgICAgICB7IG1lc3NhZ2U6IG1hdGNoaW5nRXJyb3IuaHVtYW5SZWFkYWJsZUVycm9yTWVzc2FnZSB9LFxuICAgICAgICAgICAgZXJyb3JcbiAgICAgICAgICApO1xuICAgIH1cbiAgICByZXR1cm4gQW1wbGlmeUVycm9yLmZyb21FcnJvcihlcnJvcik7XG4gIH07XG59XG4iXX0=